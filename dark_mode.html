<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Circadian: Silver & Stars</title>
  <style>
    /* --- THEME VARIABLES --- */
    :root {
      --accent-color: #b0bec5;
      --slider-track-color: #90a4ae;
      --text-light: #e0e0e0;
      --text-dark: #3a3a3a;
      --transition-speed: 1.5s;
      --ease: cubic-bezier(0.25, 0.1, 0.25, 1);
    }

    /* --- GENERAL STYLES --- */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      height: 100vh;
      margin: 0;
      color: var(--text-dark);
      background: linear-gradient(135deg, #cfd8dc 0%, #b0bec5 50%, #90a4ae 100%);
      background-size: 400% 400%;
      transition: background var(--transition-speed) var(--ease), color 1.5s var(--ease);
      position: relative;
      overflow: hidden;
    }

    body.dark-theme {
      color: var(--text-light);
    }

    /* Smooth infinite gradient animation */
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    h1 {
      margin-bottom: 20px;
      text-align: center;
      max-width: 600px;
      font-weight: 400;
      font-size: 1.4rem;
      opacity: 0.9;
      z-index: 2;
    }

    #time-display {
      font-size: 1.6rem;
      margin-top: 10px;
      font-weight: 500;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(5px);
      -webkit-backdrop-filter: blur(5px);
      padding: 8px 16px;
      border-radius: 20px;
      color: inherit;
      z-index: 2;
      opacity: 0.95;
      transition: opacity 1.2s ease;
    }

    body.dark-theme #time-display {
      background: rgba(0, 0, 0, 0.2);
      color: #e0e0e0;
    }

    /* --- SLIDER CONTAINER --- */
    .slider-container {
      width: 90%;
      max-width: 600px;
      position: relative;
      height: 6px;
      cursor: pointer;
      margin-top: 40px;
      z-index: 2;
    }

    .slider-track {
      width: 100%;
      height: 100%;
      background-color: rgba(144, 164, 174, 0.4);
      border-radius: 3px;
      box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.1);
    }

    /* --- ICON ONLY (No Thumb Circle) --- */
    #sun-moon-icon {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 36px;
      height: 36px;
      opacity: 1;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15));
      transition: all 0.3s ease;
      z-index: 3;
    }

    body.dark-theme #sun-moon-icon {
      filter: drop-shadow(0 0 8px rgba(224, 224, 224, 0.6));
    }

    /* --- STARS (Drifting Slowly) --- */
    .stars {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
      opacity: 0;
      transition: opacity 2s ease;
    }

    body.dark-theme .stars {
      opacity: 1;
    }

    .star {
      position: absolute;
      width: 1px;
      height: 1px;
      background: transparent;
      box-shadow: 
        /* Multiple twinkling stars with glow */
        20px 30px #fff,
        100px 200px #ddd,
        300px 100px #eee,
        500px 400px #fff,
        700px 150px #ddd;
      border-radius: 50%;
      opacity: 0.3;
      animation: 
        twinkle 5s infinite ease-in-out,
        drift 200s linear infinite; /* Very slow drift */
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.2; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.5); }
    }

    @keyframes drift {
      0% { transform: translate(0, 0); }
      100% { transform: translate(100vw, 100vh); }
    }

    /* --- BUTTONS --- */
    .controls {
      margin-top: 40px;
      z-index: 2;
    }

    button {
      padding: 10px 18px;
      font-size: 1rem;
      background: #b0bec5;
      color: #263238;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin: 0 10px;
      transition: all 0.3s ease;
    }

    button:hover {
      background: #cfd8dc;
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    button:active {
      transform: translateY(0);
    }

    /* --- Responsive --- */
    @media (max-width: 600px) {
      h1 { font-size: 1.2rem; }
      #time-display { font-size: 1.3rem; }
      .slider-container { width: 95%; }
    }
  </style>
</head>
<body class="light-theme">

  <!-- Drifting Stars Background -->
  <div class="stars" id="stars"></div>

  <h1>Drag to experience the flow of time</h1>
  <div id="time-display">12:00 PM</div>

  <!-- Slider Track -->
  <div class="slider-container" id="slider-container" role="slider" aria-label="Time of day" aria-valuemin="0" aria-valuemax="100" aria-valuenow="50">
    <div class="slider-track"></div>
    <!-- Floating Sun/Moon Icon (No Circle) -->
    <svg id="sun-moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <!-- Sun -->
      <circle cx="12" cy="12" r="5" class="sun"></circle>
      <line x1="12" y1="1" x2="12" y2="3" class="sun"></line>
      <line x1="12" y1="21" x2="12" y2="23" class="sun"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" class="sun"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" class="sun"></line>
      <line x1="1" y1="12" x2="3" y2="12" class="sun"></line>
      <line x1="21" y1="12" x2="23" y2="12" class="sun"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" class="sun"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" class="sun"></line>
      <!-- Moon -->
      <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" class="moon" style="display: none;"></path>
    </svg>
  </div>

  <div class="controls">
    <button id="sync-time-btn">Sync with Now</button>
  </div>

  <script>
    const sliderContainer = document.getElementById('slider-container');
    const icon = document.getElementById('sun-moon-icon');
    const body = document.body;
    const timeDisplay = document.getElementById('time-display');
    const syncTimeBtn = document.getElementById('sync-time-btn');
    const starsContainer = document.getElementById('stars');

    let isDragging = false;

    // --- Create Drifting Stars ---
    function createStars(count = 15) {
      starsContainer.innerHTML = '';
      for (let i = 0; i < count; i++) {
        const star = document.createElement('div');
        star.classList.add('star');

        // Random initial position
        star.style.left = `${Math.random() * 100}vw`;
        star.style.top = `${Math.random() * 100}vh`;

        // Random size (0.5px to 1.5px)
        const size = Math.random() * 1 + 0.5;
        star.style.width = `${size}px`;
        star.style.height = `${size}px`;

        // Random twinkle delay
        star.style.animationDelay = `${Math.random() * 5}s`;

        // Random drift duration (150s to 300s)
        const duration = 150 + Math.random() * 150;
        star.style.animation = `twinkle 5s infinite ease-in-out ${Math.random() * 5}s, drift ${duration}s linear infinite`;

        starsContainer.appendChild(star);
      }
    }

    // --- Update Theme & Icon ---
    function updateTheme(percentage) {
      const totalMinutes = percentage * 14.4;
      const hours24 = Math.floor(totalMinutes / 60) % 24;
      const minutes = Math.floor(totalMinutes % 60);
      const displayHour = hours24 % 12 || 12;
      const ampm = hours24 < 12 ? 'AM' : 'PM';

      timeDisplay.textContent = `${displayHour}:${minutes.toString().padStart(2, '0')} ${ampm}`;

      // Update icon position
      icon.style.left = `${percentage}%`;

      // Show/hide sun/moon
      const sunElements = icon.querySelectorAll('.sun');
      const moonPath = icon.querySelector('.moon');

      if (percentage > 20 && percentage < 80) {
        // Day: show sun
        sunElements.forEach(el => el.style.display = 'block');
        moonPath.style.display = 'none';
        body.classList.remove('dark-theme');
        body.classList.add('light-theme');
      } else {
        // Night: show moon
        sunElements.forEach(el => el.style.display = 'none');
        moonPath.style.display = 'block';
        body.classList.remove('light-theme');
        body.classList.add('dark-theme');
      }

      // --- Background Gradient by Time ---
      let gradient;

      if (percentage < 15) {
        gradient = 'linear-gradient(135deg, #0a0a0a 0%, #111 30%, #1a1a1a 100%)'; // Deep night
      } else if (percentage < 30) {
        gradient = 'linear-gradient(135deg, #1a1a1a 0%, #37474f 20%, #78909c 60%, #b0bec5 100%)'; // Dawn
      } else if (percentage < 70) {
        gradient = 'linear-gradient(135deg, #cfd8dc 0%, #b0bec5 50%, #90a4ae 100%)'; // Day
      } else if (percentage < 85) {
        gradient = 'linear-gradient(135deg, #90a4ae 0%, #455a64 50%, #111 100%)'; // Dusk
      } else {
        gradient = 'linear-gradient(135deg, #111 0%, #0a0a0a 100%)'; // Night
      }

      body.style.background = gradient;

      // Update ARIA
      sliderContainer.setAttribute('aria-valuenow', Math.round(percentage));
      sliderContainer.setAttribute('aria-valuetext', timeDisplay.textContent);
    }

    // --- Drag Controls ---
    function moveSlider(event) {
      if (!isDragging) return;

      const rect = sliderContainer.getBoundingClientRect();
      const clientX = event.type === 'touchmove' ? event.touches[0].clientX : event.clientX;
      const newX = Math.max(0, Math.min(clientX - rect.left, rect.width));
      const percentage = (newX / rect.width) * 100;

      updateTheme(percentage);

      if (event.type === 'touchmove') event.preventDefault();
    }

    function startDrag() {
      isDragging = true;
      icon.style.transition = 'none';
      document.body.classList.add('no-select');
    }

    function endDrag() {
      isDragging = false;
      icon.style.transition = 'left 0.2s ease';
      document.body.classList.remove('no-select');
    }

    // --- Keyboard Navigation ---
    sliderContainer.addEventListener('keydown', (e) => {
      e.preventDefault();
      const currentLeft = parseFloat(icon.style.left || 50);
      const step = 0.5;

      if (e.key === 'ArrowLeft') {
        updateTheme(Math.max(0, currentLeft - step));
      } else if (e.key === 'ArrowRight') {
        updateTheme(Math.min(100, currentLeft + step));
      }
    });

    sliderContainer.setAttribute('tabindex', 0);
    sliderContainer.style.outline = 'none';

    // --- Sync with Current Time ---
    syncTimeBtn.addEventListener('click', () => {
      const now = new Date();
      const totalMinutes = now.getHours() * 60 + now.getMinutes();
      const percentage = (totalMinutes / 1440) * 100;
      updateTheme(percentage);
    });

    // --- Events ---
    icon.addEventListener('mousedown', startDrag);
    icon.addEventListener('touchstart', (e) => {
      e.preventDefault();
      startDrag();
    });

    window.addEventListener('mousemove', moveSlider);
    window.addEventListener('touchmove', moveSlider, { passive: false });
    window.addEventListener('mouseup', endDrag);
    window.addEventListener('touchend', endDrag);

    // --- Init ---
    createStars();
    updateTheme(50); // Start at noon
  </script>
</body>
</html>